>>What is DOM (document object model) ?
The Document Object Model (DOM) is a web browser's hierarchical representation of the elements on the page.
Websites can use JavaScript to manipulate the nodes and objects of the DOM, as well as their properties.



>>When does the vulnerability arise?
DOM-based vulnerabilities arise when a website contains JavaScript that takes an attacker-controllable value, known as a source, and passes it into a dangerous function, known as a sink.
DOM-based vulnerabilities arise when a website passes data from a source to a sink, which then handles the data in an unsafe way in the context of the client's session.

>>Source : JavaScript property that accepts data that is potentially attacker-controlled. Eg. of source: location.search 

>>Sink: potentially dangerous JavaScript function or DOM object that can cause undesirable effects if attacker-controlled data is passed to it. 
Eg. of sink > eval() function.
eg. of HTML sink : document.body.innerHTML 


>>Common Sources:
document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database

>Types of data that can be used as sources to exploit taint-flow vulnerabilities.
Reflected data
Stored Data
Web Messages 


DOM-based vulnerability	Example sink
DOM XSS LABS	document.write()
Open redirection LABS	window.location
Cookie manipulation LABS	document.cookie
JavaScript injection	eval()
Document-domain manipulation	document.domain
WebSocket-URL poisoning	WebSocket()
Link manipulation	element.src
Web message manipulation	postMessage()
Ajax request-header manipulation	setRequestHeader()
Local file-path manipulation	FileReader.readAsText()
Client-side SQL injection	ExecuteSql()
HTML5-storage manipulation	sessionStorage.setItem()
Client-side XPath injection	document.evaluate()
Client-side JSON injection	JSON.parse()
DOM-data manipulation	element.setAttribute()
Denial of service	RegExp()















